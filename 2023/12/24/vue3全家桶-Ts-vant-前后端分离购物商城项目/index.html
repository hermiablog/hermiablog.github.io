<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="vue3全家桶+Ts+vant 前后端分离购物商城项目介绍, 技术博客">
    <meta name="description" content="个人技术博客">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>vue3全家桶+Ts+vant 前后端分离购物商城项目介绍 | hermia&#39;s blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 6.3.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>



   <style>
    body{
       background-image: url(https://cdn.pixabay.com/photo/2012/04/14/16/37/sky-34536_1280.png);
       background-repeat:no-repeat;
       background-size:cover;
       background-attachment:fixed;
    }
</style>



<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">hermia&#39;s blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">hermia&#39;s blog</div>
        <div class="logo-desc">
            
            个人技术博客
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/41.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">vue3全家桶+Ts+vant 前后端分离购物商城项目介绍</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link
  rel="stylesheet"
  href="/libs/tocbot/tocbot.css"
/>
<style>
  #articleContent h1::before,
  #articleContent h2::before,
  #articleContent h3::before,
  #articleContent h4::before,
  #articleContent h5::before,
  #articleContent h6::before {
    display: block;
    content: " ";
    height: 100px;
    margin-top: -100px;
    visibility: hidden;
  }

  #articleContent :focus {
    outline: none;
  }

  .toc-fixed {
    position: fixed;
    top: 64px;
  }

  /* .toc-widget {
        width: 345px;
        padding-left: 20px;
    } */
  .toc-widget {
    width: 345px;
    padding-left: 20px;
    background-color: rgb(255, 255, 255, 0.7);
    border-radius: 10px;
    box-shadow: 0 10px 35px 2px rgba(0, 0, 0, 0.15),
      0 5px 15px rgba(0, 0, 0, 0.07), 0 2px 5px -5px rgba(0, 0, 0, 0.1) !important;
  }

  .toc-widget .toc-title {
    padding: 35px 0 15px 17px;
    font-size: 1.5rem;
    font-weight: bold;
    line-height: 1.5rem;
  }

  .toc-widget ol {
    padding: 0;
    list-style: none;
  }

  #toc-content {
    padding-bottom: 30px;
    overflow: auto;
  }

  #toc-content ol {
    padding-left: 10px;
  }

  #toc-content ol li {
    padding-left: 10px;
  }

  #toc-content .toc-link:hover {
    color: #a3ddf0;
    font-weight: 700;
    text-decoration: underline;
  }

  #toc-content .toc-link::before {
    background-color: transparent;
    max-height: 25px;

    position: absolute;
    right: 23.5vw;
    display: block;
  }

  #toc-content .is-active-link {
    color: #a3ddf0;
  }

  #floating-toc-btn {
    position: fixed;
    right: 15px;
    bottom: 76px;
    padding-top: 15px;
    margin-bottom: 0;
    z-index: 998;
  }

  #floating-toc-btn .btn-floating {
    width: 48px;
    height: 48px;
  }

  #floating-toc-btn .btn-floating i {
    line-height: 48px;
    font-size: 1.4rem;
  }
</style>
<div class="row">
  <div id="main-content" class="col s12 m12 l9">
    <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/app/">
                                <span class="chip bg-color">app</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-12-24
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2023-12-24
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    9.1k
                </div>
                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <span id="more"></span>
<h2 id="项目介绍"><a href="#项目介绍" class="headerlink" title="项目介绍"></a>项目介绍</h2><p>欢迎访问：<a target="_blank" rel="noopener" href="https://web.hermiablog.com/">https://web.hermiablog.com/</a></p>
<ul>
<li>github地址：<a target="_blank" rel="noopener" href="https://github.com/hermiablog/shopApp">https://github.com/hermiablog/shopApp</a> (包括前后端数据)</li>
<li>了解更多：<code>hermiablog.com</code></li>
</ul>
<h4 id="项目技术栈"><a href="#项目技术栈" class="headerlink" title="项目技术栈"></a>项目技术栈</h4><p>本次 Vue 项目用到的技术栈、构建工具、组件库、代码检查、代码格式化工具。如下表：</p>
<table>
<thead>
<tr>
<th>工具</th>
<th>描述</th>
<th>版本</th>
</tr>
</thead>
<tbody><tr>
<td>Node</td>
<td>JS 运行时环境</td>
<td>20.9.0</td>
</tr>
<tr>
<td>Vue</td>
<td>渐进式 JS 框架</td>
<td>3.3.10</td>
</tr>
<tr>
<td>TypeScript</td>
<td>具有类型语法的 JS</td>
<td>5.2.0</td>
</tr>
<tr>
<td>Vite</td>
<td>前端构建工具</td>
<td>5.0.5</td>
</tr>
<tr>
<td>Vue Router</td>
<td>Vue.js 的官方路由</td>
<td>4.2.5</td>
</tr>
<tr>
<td>Pinia</td>
<td>Vue.js 状态管理库</td>
<td>2.1.7</td>
</tr>
<tr>
<td>Vant</td>
<td>移动端 Vue 组件库</td>
<td>4.8.0</td>
</tr>
<tr>
<td>VueUse</td>
<td>基于 Vue 组合式 API 的实用函数集合</td>
<td>10.7.0</td>
</tr>
<tr>
<td>ESLint</td>
<td>代码检查工具，统一代码规范</td>
<td>8.49.0</td>
</tr>
<tr>
<td>Prettier</td>
<td>代码格式化工具</td>
<td>3.0.3</td>
</tr>
<tr>
<td>json-server</td>
<td>模拟服务端接口数据</td>
<td>0.17.4</td>
</tr>
<tr>
<td>jsonwebtoken</td>
<td>生成 和 校验 token</td>
<td>9.0.2</td>
</tr>
<tr>
<td>axios</td>
<td>异步请求</td>
<td>1.6.2</td>
</tr>
<tr>
<td>postcss</td>
<td>利用 JavaScript 的强大编程能力对 CSS 代码进行转换</td>
<td>8.4.32</td>
</tr>
<tr>
<td>sass</td>
<td>CSS 预处理器</td>
<td>1.69.5</td>
</tr>
</tbody></table>
<h4 id="项目页面"><a href="#项目页面" class="headerlink" title="项目页面"></a>项目页面</h4><p>本项目所涉及到的页面有：首页、购物车、订单、我的、商家店铺、商品详情、订单支付、登录、注册、地址管理、编辑地址、搜索页<br><img src="https://github.com/hermiablog/shopApp/blob/main/screen/introduce.png" style="max-width: 100%;"></p>
<h4 id="项目功能"><a href="#项目功能" class="headerlink" title="项目功能"></a>项目功能</h4><p>本项目中涉及到的一些功能主要用：</p>
<ul>
<li>搜索功能</li>
<li>轮播图</li>
<li>弹出层和弹窗</li>
<li>倒计时</li>
<li>滚动菜单</li>
<li>滚动加载</li>
<li>下拉刷新</li>
<li>图片懒加载</li>
<li>单选与全选</li>
<li>加入购物车</li>
<li>地址管理（选择、新增、修改、删除、默认设置）</li>
<li>短信验证码登录与注册</li>
<li>token 身份认证</li>
</ul>
<h4 id="项目技术点"><a href="#项目技术点" class="headerlink" title="项目技术点"></a>项目技术点</h4><p>本项目所涉及到的技术栈和相关知识点，如下</p>
<blockquote>
<p>Vue3 框架</p>
</blockquote>
<ul>
<li>基础知识应用</li>
<li>ref 和 reactive</li>
<li>computed 和 watch</li>
<li>组件封装</li>
<li>自定义指令 directive</li>
<li>composition API</li>
<li>生命周期</li>
<li>VueUse 基本用法</li>
<li>ESLint 和 Prettier 基础配置</li>
</ul>
<blockquote>
<p>Vue Route4</p>
</blockquote>
<ul>
<li>基础用法</li>
<li>动态路由匹配</li>
<li>导航守卫</li>
</ul>
<blockquote>
<p>Pinia 状态管理</p>
</blockquote>
<ul>
<li>基础用法</li>
<li>state</li>
<li>getter</li>
<li>action</li>
<li>数据本地持久化(localstorage)</li>
</ul>
<blockquote>
<p>构建工具 Vite</p>
</blockquote>
<ul>
<li>Vite 构建项目</li>
<li>配置 eslint、prettier</li>
<li>设置请求代理</li>
</ul>
<blockquote>
<p>TypeScript</p>
</blockquote>
<ul>
<li>基础用法</li>
<li>函数</li>
<li>接口 interface</li>
<li>类 Class</li>
<li>泛型</li>
</ul>
<blockquote>
<p>Axios</p>
</blockquote>
<ul>
<li>创建 axios 实例</li>
<li>get、post、put、deleted 请求</li>
<li>axios 封装</li>
<li>请求和响应拦截器</li>
</ul>
<blockquote>
<p>Vant 组件</p>
</blockquote>
<ul>
<li>Icon 图标</li>
<li>Popup 弹出层</li>
<li>Checkbox 复选框</li>
<li>Form 表单</li>
<li>Search 搜索</li>
<li>PullRefresh 下拉刷新</li>
<li>Lazyload 懒加载</li>
<li>List 列表</li>
<li>Sticky 粘性布局</li>
<li>Swipe 轮播</li>
<li>IndexBar 索引栏</li>
<li>NavBar 导航栏</li>
<li>Tab 标签页</li>
<li>Tabbar 标签栏</li>
<li>Area 省市区选择</li>
<li>Dialog 弹出框</li>
<li>CountDown 倒计时</li>
</ul>
<blockquote>
<p>服务器端</p>
</blockquote>
<ul>
<li>json-server 模拟服务端接口数据</li>
<li>Http 状态码与业务状态码</li>
<li>jsonwebtoken 生成和校验 token</li>
<li>申请短信验证码接口</li>
<li>json-server 模拟服务端接口数据</li>
</ul>
<h2 id="项目搭建过程"><a href="#项目搭建过程" class="headerlink" title="项目搭建过程"></a>项目搭建过程</h2><h3 id="一、基础框架、准备工作"><a href="#一、基础框架、准备工作" class="headerlink" title="一、基础框架、准备工作"></a>一、基础框架、准备工作</h3><h4 id="开发环境初始化"><a href="#开发环境初始化" class="headerlink" title="开发环境初始化"></a>开发环境初始化</h4><blockquote>
<p>创建Vue项目，集成相关工具：TS、Vue Router、Pinia、ESLint、Prettier、Vant、VueUse等</p>
</blockquote>
<ul>
<li>执行以下代码，并开启相关功能</li>
</ul>
<pre><code>npm create vue@latest
</code></pre>
<blockquote>
<p>安装Vant组件</p>
</blockquote>
<pre><code># Vue 3 项目，安装最新版 Vant
npm i vant
</code></pre>
<ul>
<li>按需引入</li>
</ul>
<pre><code># 通过 npm 安装
npm i @vant/auto-import-resolver unplugin-vue-components -D
</code></pre>
<ul>
<li>配置插件:修改<code>vite.config.ts</code>配置文件</li>
</ul>
<pre><code>import vue from &#39;@vitejs/plugin-vue&#39;;
import Components from &#39;unplugin-vue-components/vite&#39;;
import &#123; VantResolver &#125; from &#39;@vant/auto-import-resolver&#39;;

export default &#123;
  plugins: [
    vue(),
    Components(&#123;
      resolvers: [VantResolver()],
    &#125;),
  ],
&#125;;
</code></pre>
<blockquote>
<p>安装VueUse</p>
</blockquote>
<pre><code>npm i @vueuse/core
</code></pre>
<h4 id="页面结构与路由"><a href="#页面结构与路由" class="headerlink" title="页面结构与路由"></a>页面结构与路由</h4><blockquote>
<p>页面结构梳理</p>
</blockquote>
<table>
<thead>
<tr>
<th>页面</th>
<th>路由</th>
<th>路由组件</th>
</tr>
</thead>
<tbody><tr>
<td>首页</td>
<td>&#x2F;</td>
<td><code>/src/views/home/Index.vue</code></td>
</tr>
<tr>
<td>购物车</td>
<td>&#x2F;cart</td>
<td><code>/src/views/cart/CartIndex.vue</code></td>
</tr>
<tr>
<td>订单</td>
<td>&#x2F;order</td>
<td><code>/src/views/order/OrderIndex.vue</code></td>
</tr>
<tr>
<td>我的</td>
<td>&#x2F;my</td>
<td><code>/src/views/my/MyIndex.vue</code></td>
</tr>
<tr>
<td>登录</td>
<td>&#x2F;login</td>
<td><code>/src/views/login/LoginIndex.vue</code></td>
</tr>
<tr>
<td>注册</td>
<td>&#x2F;register</td>
<td><code>/src/views/register/RegisterIndex.vue</code></td>
</tr>
<tr>
<td>商家店铺</td>
<td>&#x2F;shop&#x2F;:shopId</td>
<td><code>/src/views/shop/ShopIndex.vue</code></td>
</tr>
<tr>
<td>商品详情</td>
<td>&#x2F;goods-details&#x2F;:shopId&#x2F;:goodsId</td>
<td><code>/src/views/goods/GoodsIndex.vue</code></td>
</tr>
<tr>
<td>订单支付</td>
<td>&#x2F;order&#x2F;confirmation&#x2F;:shopId</td>
<td><code>/src/views/order/OrderComfirmation.vue</code></td>
</tr>
<tr>
<td>地址管理</td>
<td>&#x2F;address</td>
<td><code>/src/views/address/AddressIndex.vue</code></td>
</tr>
<tr>
<td>新增或修改地址</td>
<td>&#x2F;address&#x2F;edit</td>
<td><code>/src/views/address/AddressEdit.vue</code></td>
</tr>
</tbody></table>
<blockquote>
<p>路由配置</p>
</blockquote>
<ul>
<li>修改<code>router/index.ts</code>文件，配置路由</li>
</ul>
<h4 id="CSS样式处理"><a href="#CSS样式处理" class="headerlink" title="CSS样式处理"></a>CSS样式处理</h4><blockquote>
<p>安装<code>normalize.css</code>，用来处理不同浏览器的兼容</p>
<ul>
<li>注意：它并不是很全面</li>
</ul>
</blockquote>
<pre><code>npm i normalize.css
</code></pre>
<ul>
<li>在<code>main.ts</code>中引入</li>
</ul>
<pre><code>import &quot;normailize.css&quot;
</code></pre>
<blockquote>
<p>安装sass</p>
</blockquote>
<ul>
<li>安装sass css预处理器</li>
</ul>
<pre><code>npm install sass -D
</code></pre>
<blockquote>
<p>添加字体抗锯齿效果</p>
</blockquote>
<ul>
<li>在<code>App.vue</code>中添加以下样式</li>
</ul>
<pre><code>#app &#123;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smothing: grayscale; 
&#125;
</code></pre>
<blockquote>
<p>公共样式文件<br>在<code>/src/assets</code>目录下新建<code>common.scss</code>文件，用于存放整个项目的公共样式</p>
</blockquote>
<ul>
<li>重置</li>
<li>设置通用样式</li>
<li>溢出文本省略等公共样式</li>
<li>设置苹方字体<ul>
<li>使用<code>@font-face</code>声明所需字体，format表示如果用户代理不支持指定的格式，就跳过下载字体资源</li>
<li>在<code>font-family</code>中引用该字体</li>
</ul>
</li>
</ul>
<h4 id="移动端适配与浏览器兼容性处理"><a href="#移动端适配与浏览器兼容性处理" class="headerlink" title="移动端适配与浏览器兼容性处理"></a>移动端适配与浏览器兼容性处理</h4><blockquote>
<p>vw布局——自动转换单位</p>
</blockquote>
<p>使用<code>postcss-px-to-viewport-8-plugin</code>插件进行转换</p>
<ul>
<li>安装</li>
</ul>
<pre><code>npm install postcss-px-to-viewport-8-plugin -D
</code></pre>
<ul>
<li>配置：在根目录下新建<code>postcss.config.js</code>文件</li>
</ul>
<pre><code>module.exports = &#123;
  plugins: &#123;
    &#39;postcss-px-to-viewport-8-plugin&#39;: &#123;
      viewportWidth: 375,//设计稿的视口宽度
      exclude: [/node_modules/],
      unitToConvert: &#39;px&#39;,
      minPixelValue: 1, //设置最小的转换数值
      selectorBlackList: [/^body$/], //需要忽略的 CSS 选择器
    &#125;
  &#125;
&#125;
</code></pre>
<blockquote>
<p>CSS兼容性处理</p>
</blockquote>
<ul>
<li>安装autoprefixer插件——自动为css属性添加不同的浏览器前缀</li>
</ul>
<pre><code>npm i autoprefixer -D
</code></pre>
<ul>
<li>在<code>postcss.config.js</code>文件中配置该插件</li>
</ul>
<pre><code>module.exports = &#123;
  plugins: &#123;
    &#39;autoprefixer&#39;:&#123;&#125;
  &#125;
&#125;
</code></pre>
<ul>
<li>在<code>package.json</code>中添加兼容到的浏览器版本</li>
</ul>
<pre><code>&#123;
  &quot;browserslist&quot;:[
    &quot;Andriod&gt;=4.0&quot;,
    &quot;iOS&gt;=7&quot;
  ]
&#125;
</code></pre>
<blockquote>
<p>JS兼容性处理</p>
</blockquote>
<ul>
<li>安装<code>@vitejs/plugin-legacy</code>插件，为打包后的JS文件提供浏览器兼容性支持</li>
</ul>
<pre><code>npm i @vitejs/plugin-legacy -D
</code></pre>
<ul>
<li>必须同时安装 Terser，因为旧版插件使用 Terser 进行缩小</li>
</ul>
<pre><code>npm add -D terser
</code></pre>
<ul>
<li>在<code>vite.config.js</code>文件中配置该插件</li>
</ul>
<pre><code>// vite.config.js
import legacy from &#39;@vitejs/plugin-legacy&#39;

export default &#123;
  plugins: [
    legacy(&#123;
      //target放到package.json中
    &#125;),
  ],
&#125;
</code></pre>
<ul>
<li>为了和css保持一样的兼容性版本，把兼容到的目标浏览器配置<code>targets</code>，添加到<code>package.json</code>的<code>browserslist</code>字段中</li>
</ul>
<pre><code>&#123;
  &quot;browserslist&quot;:[
    &quot;Andriod&gt;=4.0&quot;,
    &quot;iOS&gt;=7&quot;
  ]
&#125;
</code></pre>
<h4 id="API接口调用设计"><a href="#API接口调用设计" class="headerlink" title="API接口调用设计"></a>API接口调用设计</h4><p>创建Axios实例</p>
<blockquote>
<p>我们需要通过axios发送大量HTTP请求，因此创建Axios实例将其中相同的配置放在一起</p>
</blockquote>
<ul>
<li>安装axios</li>
</ul>
<pre><code>npm install axios
</code></pre>
<ul>
<li>新建<code>/src/api/base.ts</code>文件，来创建实例</li>
</ul>
<pre><code>import axios from &#39;axios&#39;
const instance = axios.create(&#123;
  baseURL: &#39;/api&#39;,
  timeout: 3000,
&#125;);

export default instance
</code></pre>
<ul>
<li>配置代理——修改<code>vite.config.ts</code>文件</li>
</ul>
<pre><code>server:&#123;
  proxy:&#123;
    &#39;/api&#39;:&#39;http://127.0.0.1:8888&#39;
  &#125;
&#125;
</code></pre>
<blockquote>
<p>使用示例</p>
</blockquote>
<ul>
<li>新建<code>/src/api/test.ts</code>文件，引入axios实例，将接口封装成方法暴露出去</li>
</ul>
<pre><code>//这里给axios实例取别名为axios 
import axios from &#39;@/api/base&#39;

export function getFruits()&#123;
  return axios.get(&#39;/getFruits&#39;)
&#125;
</code></pre>
<ul>
<li>使用时，只需要导入请求的方法，进行调用</li>
</ul>
<pre><code>import &#123; getFruits &#125; from &#39;@/api/test&#39;
const list = ref([])
const getFruitsList = async () =&gt; &#123;
  try&#123;
    list.value = await getFruits()
  &#125; catch (err)&#123;
    list.value = []
  &#125;
&#125;
getFruitsList()
</code></pre>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.axios-http.cn/docs/instance">Axios实例官方文档</a></p>
</blockquote>
<p>身份验证流程<br><img src="https://github.com/hermiablog/shopApp/blob/main/screen/identityAuth.png" style="max-width: 100%;"></p>
<p>拦截器<br>拦截器分为请求拦截器和响应拦截器</p>
<ul>
<li>请求拦截器：在发送请求之前被调用</li>
<li>响应拦截器：在响应被then或catch处理前被调用</li>
</ul>
<blockquote>
<p>作用</p>
</blockquote>
<ul>
<li>在请求拦截器中给请求头添加<code>Authorization</code>字段携带认证的Token</li>
<li>在响应拦截器中根据响应数据的业务状态码来做相关的处理</li>
</ul>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.axios-http.cn/docs/interceptors">拦截器官方文档</a></p>
</blockquote>
<blockquote>
<p>请求拦截器</p>
</blockquote>
<pre><code>// 添加请求拦截器
instance.interceptors.request.use(function (config) &#123;
    // 在发送请求之前将token保存到localStorage
    const token=window.localStorage.getItem(&#39;token&#39;)
    // 如果有token
    if(token)&#123;
      config.headers[&quot;Authorization&quot;]=token
      &#125;
    return config;
  &#125;, function (error) &#123;
    // 对请求错误做些什么
    return Promise.reject(error);
  &#125;);
</code></pre>
<blockquote>
<p>响应拦截器</p>
</blockquote>
<pre><code>// 添加响应拦截器
instance.interceptors.response.use(async (response)=&gt; &#123;
    // 2xx 范围内的状态码都会触发该函数。
    // 身份认证成功，就走这里 返回相应的数据
    const &#123;data:_data&#125;=response;
    const &#123;data,code,msg&#125;=_data;
    // 根据业务状态码来判断要做的事
    if(code===-1)&#123;
    await showDialog(&#123;
        title:&quot;错误提示&quot;,
        message:msg
      &#125;)
      return Promise.reject(msg);
    &#125;
    return data
  &#125;, function (error) &#123;
    // 超出 2xx 范围的状态码都会触发该函数。
    // 如果身份认证失败，就弹出提示框并跳转到登录界面
    if(error.response&amp;&amp;error.response.status===401)&#123;
      showDialog(&#123;
        title:&quot;请登录&quot;,
        message:&quot;没有访问权限，请登录后再试&quot;
      &#125;).then(()=&gt;&#123;
        window.location.href=&quot;https//www.baidu.com&quot;
      &#125;)
    &#125;
  &#125;);
</code></pre>
<h3 id="二、登录注册与短信验证"><a href="#二、登录注册与短信验证" class="headerlink" title="二、登录注册与短信验证"></a>二、登录注册与短信验证</h3><h4 id="文件说明"><a href="#文件说明" class="headerlink" title="文件说明"></a>文件说明</h4><pre><code>shopApp
├─ jsonServer
│  ├─ .env
│  ├─ src
│  │  ├─ controller
│  │  │  ├─ phoneIsExisted.controller.js   //检验电话号码是否已注册
│  │  │  ├─ SmsCodeSend.controller.js    // 用于发送验证码
│  │  │  ├─ SmsCodeCheck.controller.js   // 用于检验用户输入的验证码是否符合要求
│  │  │  └─ userNameIsExisted.controller.js  //检验用户名是否已注册
│  │  ├─ data
│  │  │  ├─ smsCodeData.js  //包含手机号、验证码、过期时间的数据库 
│  │  │  └─ userList.js  //包含用户手机号、用户名、密码等个人信息的数据库
│  │  ├─ routes.js  //路由
│  │  └─ service
│  │     ├─ sendCodeService.js  // 使用阿里云短信服务 发送短信
│  └─ utils
│     └─ randomNum.js  //随机生成n位数字的方法
└─ vue-shop
   ├─ src
   │  ├─ use
   │  │  └─ UseSmsCode.ts
   │  ├─ utils
   │  │  └─ regular.ts
   │  └─ views
   │     └─ register
   │        └─ RegisterIndex.vue
</code></pre>
<h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><table>
<thead>
<tr>
<th></th>
<th>客户端</th>
<th>服务端</th>
</tr>
</thead>
<tbody><tr>
<td>验证手机号</td>
<td>正则校验，发起请求查询手机号是否已注册</td>
<td>根据手机号查询数据库</td>
</tr>
<tr>
<td>验证用户名</td>
<td>正则校验，发起请求查询用户名是否已注册</td>
<td>根据用户名查询数据库</td>
</tr>
<tr>
<td>发送验证码</td>
<td>发起请求、进行倒计时</td>
<td>拿到手机号发送短信验证码</td>
</tr>
<tr>
<td>验证验证码</td>
<td>正则校验，发起请求验证验证码是否正确</td>
<td>根据手机号、验证码查询数据库</td>
</tr>
<tr>
<td>注册</td>
<td>信息有效、勾选协议，发起请求进行注册</td>
<td>将用户信息添加进数据库，返回不带密码的用户信息数据</td>
</tr>
</tbody></table>
<h4 id="实现注册"><a href="#实现注册" class="headerlink" title="实现注册"></a>实现注册</h4><p>组件</p>
<ul>
<li>使用vantUI的Form表单组件，可以根据rule属性进行校验、使用异步函数发起后端请求</li>
</ul>
<p>验证手机号、用户名</p>
<blockquote>
<p>前端——校验规则配置——rule属性</p>
</blockquote>
<ul>
<li>required：是否为必选字段，当值为空值时校验不通过</li>
<li>pattern：使用正则校验输入框内容</li>
<li>validator：发起异步请求，调用接口</li>
</ul>
<blockquote>
<p>后端</p>
</blockquote>
<ul>
<li>新建数据库<code>smsCodeData</code></li>
<li>分别创建连个无需认证的接口，获取请求体中携带的数据，查询其是否在数据中已存在，并返回相应信息</li>
<li>手机号验证接口：<code>/api/register/phone/check</code></li>
<li>用户名验证接口：<code>/api/register/username/check</code></li>
</ul>
<p>获取验证码</p>
<blockquote>
<p>开通验证码的功能——阿里云平台短信服务功能</p>
</blockquote>
<ul>
<li>注册账号</li>
<li>完成实名认证</li>
<li>进入短信控制台</li>
<li>开通短信服务，申请签名、模板等</li>
<li>调用API发送短信(SDK版本v1.0、Node.js)</li>
<li>申请授权密钥<ul>
<li>AccessKey管理</li>
<li>开通子账户</li>
<li>获取密钥</li>
<li>添加短信权限</li>
</ul>
</li>
</ul>
<blockquote>
<p>前端点击获取验证码，开启倒计时，向接口发起请求</p>
</blockquote>
<blockquote>
<p>后端根据手机号，发送验证码</p>
</blockquote>
<ul>
<li>新建发送验证码的接口：<code>/api/register/code/send</code></li>
<li>新建发送验证码的通用方法，并在接口文件中调用；</li>
<li>接入阿里云平台短信服务功能<ul>
<li>将SDK示例代码复制到发送验证码的接口文件中</li>
<li>新建<code>.env</code>文件，保存密钥，导入<code>dotenv</code>包解析环境变量</li>
</ul>
</li>
<li>模拟验证码数据库，保存手机号、验证码、过期时间<ul>
<li>在发送验证码的接口中，生成验证码并发送验证码后，要检查数据库中；如果已经有该手机号，如果有就更新验证码和过期时间；如果没有就新增一条数据</li>
</ul>
</li>
</ul>
<p>验证验证码</p>
<blockquote>
<p>前端</p>
</blockquote>
<ul>
<li>在异步函数中调用接口</li>
</ul>
<blockquote>
<p>后端</p>
</blockquote>
<ul>
<li>新建验证接口：<code>/api/register/code/check</code></li>
<li>到数据库中查询，传入的手机号和验证码是否正确，该验证码是否未过期</li>
</ul>
<p>注册</p>
<blockquote>
<p>前端</p>
</blockquote>
<ul>
<li>输入用户信息及验证码，勾选协议</li>
<li>注册成功后，跳转到登录页<blockquote>
<p>后端</p>
</blockquote>
</li>
<li>新建接口：<code>/api/register</code></li>
<li>将用户信息添加到数据库中，并将密码以外的信息返回到前端</li>
</ul>
<h4 id="实现登录"><a href="#实现登录" class="headerlink" title="实现登录"></a>实现登录</h4><p>组件</p>
<ul>
<li>使用vantUI的Form表单组件，可以根据rule属性进行校验、使用异步函数发起后端请求</li>
</ul>
<p>验证手机号格式：</p>
<ul>
<li>前端校验：利用正则规范输入框内容的格式</li>
</ul>
<p>获取验证码：</p>
<ul>
<li>新建接口：<code>/api/login/code/send</code></li>
<li>实现方式和注册时一样</li>
</ul>
<p>验证验证码</p>
<ul>
<li>定义新的数据库，存储登录时的手机号与验证码</li>
<li>创建新的接口：<code>/api/login/code/check</code></li>
<li>实现方式和注册时一样</li>
</ul>
<p>登录</p>
<ul>
<li>新建接口：<code>/api/smsLogin</code></li>
<li>首先根据手机号，在数据库中查找是否已存在；如果没有注册过，就为该手机号创建默认账户</li>
<li>注册后&#x2F;已注册：返回无密码的账户信息和token</li>
</ul>
<p>用户信息和token的存储</p>
<ul>
<li>效果：使用pinia，作为全局变量存储，同时要保存在localStorage中</li>
<li>创建仓库，里面保存了<ul>
<li>用户信息：未登录时和登录后的信息</li>
<li>新增数据的方法：根据传入的result更新用户信息，并将用户信息和<code>token</code>保存在<code>localStorage</code>中</li>
<li>删除用户信息的方法：将用户信息恢复默认值、清空token</li>
</ul>
</li>
<li>当登陆成功后，创建仓库实例，使用新增数据的方法将result传入</li>
</ul>
<h3 id="三、我的页面"><a href="#三、我的页面" class="headerlink" title="三、我的页面"></a>三、我的页面</h3><p>顶部页面的渲染</p>
<ul>
<li>登录&#x2F;注册后，接口会返回用户信息</li>
<li>使用保存用户信息的仓库，拿到里面的信息进行渲染，使登录前和登录后状态实现变化</li>
<li>注意：用户头像在登录前后来源不一样；但图片的地址前缀都是本地服务器<ul>
<li>所以要对<code>/images</code>进行代理，使登录后的图片地址转到后端服务器；</li>
<li>而未登录时默认头像是在前端，所以不能放在<code>/images</code>文件夹里，创建<code>img</code>文件夹进行存放</li>
</ul>
</li>
</ul>
<h3 id="四、首页"><a href="#四、首页" class="headerlink" title="四、首页"></a>四、首页</h3><p>页面组成</p>
<pre><code>HomeIndex
├─ 顶部导航
├─ 定位 —— LocationView
├─ 搜索 —— HomeSearch
│  ├─ 搜索框
│  └─ 搜索页 —— SearchPage
│     ├─ 搜索框
│     └─ 历史记录 —— HistoryView 
├─ 轮播图 —— BannerView
├─ 分类菜单 —— HomeMenu
├─ 特价秒杀 —— PriceKillView
└─ 分类推荐 —— HomeRecommand
</code></pre>
<h4 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h4><p>在首页点击搜索框跳转到搜索页</p>
<ul>
<li>搜索组件<code>HomeSearch</code>同时存在搜索框和弹出层两部分，使用<code>showPop</code>变量控制显隐，默认是<code>false</code>，弹出层只在它为<code>true</code>时显示</li>
<li>当搜索框被点击后，<code>showPop===true</code>弹出层显示，弹出层由搜索页组件<code>SearchPage</code>渲染</li>
</ul>
<p>搜索页<code>SearchPage</code></p>
<ul>
<li>搜索框输入内容后，拿到关键词向后端发起请求，获取对应内容</li>
<li>关闭搜索页：<ul>
<li>点击关闭图标时，触发父组件传递的close事件</li>
<li>清空店铺数据</li>
<li>清空输入框的值</li>
</ul>
</li>
</ul>
<p>组件：历史记录<code>HistoryView</code></p>
<ul>
<li>该组件仅在没有商店数据时显示(即搜索出数据后，不显示历史记录)</li>
<li>接收父组件传递的历史记录<code>historyList</code></li>
<li>有历史记录时，默认显示最近八条记录，如果有的话，支持展开更多</li>
<li>点击删除图标可使用父组件传递的事件，清空<code>historyList</code></li>
<li>点击单条历史记录将该值传给父组件<code>SearchPage</code></li>
</ul>
<p>搜索接口 </p>
<ul>
<li>创建店铺信息的数据库</li>
<li>定义搜索接口，根据参数：keyword、page、limit返回相应数据；page、limit是可选参数，不传时使用默认值</li>
<li>在搜索时使用接口，传入参数，获取数据；接口名：<code>/api/search?keyword=0&amp;page=1&amp;limit=10</code></li>
<li>未登录时不能搜索，将搜索接口设置为受保护接口，响应拦截器会进行拦截，并跳转到登录页</li>
</ul>
<p>搜索框</p>
<ul>
<li>搜索框在输入关键词点击搜索后，<ul>
<li>将关键词添加到本地</li>
<li>给接口传入参数，搜索出对应内容</li>
</ul>
</li>
</ul>
<p>点击历史记录搜索</p>
<ul>
<li>接收子组件传来的值，修改搜索框的值</li>
<li>触发onSearch事件</li>
</ul>
<p>在搜索页渲染店铺</p>
<ul>
<li>使用for循环遍历店铺组件<code>shopItem</code></li>
<li>给组件传入搜索后得到的数据</li>
</ul>
<p>上拉加载更多 —— List 列表</p>
<table>
<thead>
<tr>
<th>属性&#x2F;事件</th>
<th>初始值</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>v-model:loading</td>
<td>false</td>
<td>false表示没有在加载数据；true正在更新数据</td>
</tr>
<tr>
<td>v-model:error</td>
<td>false</td>
<td>true表示数据加载失败，并显示错误提示，用户点击错误提示后会重新触发 load 事件</td>
</tr>
<tr>
<td>finished</td>
<td>false</td>
<td>true表示数据已全部加载完毕</td>
</tr>
<tr>
<td>offset</td>
<td>300</td>
<td>滚动条与底部距离小于 offset 时触发 load 事件</td>
</tr>
<tr>
<td>loading-text</td>
<td>加载中…</td>
<td>加载过程中的提示文案</td>
</tr>
<tr>
<td>@load事件</td>
<td>-</td>
<td>异步更新数据</td>
</tr>
</tbody></table>
<blockquote>
<p>原理</p>
</blockquote>
<ul>
<li>在loading为false的前提下，组件加载的瞬间&#x2F;组件滚动到底部时，会触发 load 事件，并将loading 设置成 true</li>
<li>因此1：在进入搜索页的瞬间会马上加载数据(但是都没搜索哪来的数据)</li>
<li>因此2：要使每次搜索时都加载数据，就得定义一个变量<code>searchState</code>控制店铺列表的显隐</li>
<li>因此3：每一次加载完(无论有无数据)都要使loading为false</li>
</ul>
<blockquote>
<p>使用</p>
</blockquote>
<ul>
<li>将List列表包裹在店铺组件外面</li>
<li>在List列表外再加一层控制其显隐</li>
</ul>
<blockquote>
<p>与搜索方法联调</p>
</blockquote>
<ul>
<li>将onSearch方法中用于获取数据的异步方法剪切到onLoad方法中</li>
<li>上拉加载更多：<ul>
<li>使每次获取数据的<code>page++</code>，直到数据长度大于<code>total</code>，就将<code>finished</code>设为<code>true</code>，表示数据已全部加载完毕</li>
<li>在每次搜索前将<code>page=0</code>，将<code>shopList</code>清空，将<code>finished</code>设为<code>false</code></li>
</ul>
</li>
<li>在<code>onSearch</code>方法中使用两个定时器控制店铺列表的显隐，在点击搜索的0毫秒将<code>searchState=false</code>隐藏，100毫秒时将<code>searchState=true</code>显示店铺，触发<code>onLoad</code>事件</li>
</ul>
<blockquote>
<p>注意事项</p>
</blockquote>
<ul>
<li>不能在点击搜索后清空输入框的值，这将导致<code>onLoad</code>事件拿不到搜索的内容</li>
<li>不能为了进入搜索页时不加载数据 而给<code>List</code>列表设置<code>immediate-check</code>属性，这将导致无法触发onload事件，使用变量控制显隐一举两得</li>
</ul>
<p>下拉刷新——List 组件与 PullRefresh 组件结合使用</p>
<ul>
<li><code>refreshing</code>默认值为false，true表示正在加载中，</li>
<li>下拉后就会触发<code>refresh</code>事件，并将<code>refreshing=true</code></li>
<li>在<code>refresh</code>事件中<ul>
<li>将数据更新为最新一条</li>
<li>将<code>loading</code>设为true，表示正在加载中，会有加载中的文字</li>
<li>将<code>finished = false，page.value = 0</code>表示开始新一轮搜索</li>
</ul>
</li>
</ul>
<h4 id="店铺组件shopItem"><a href="#店铺组件shopItem" class="headerlink" title="店铺组件shopItem"></a>店铺组件<code>shopItem</code></h4><p>数据的渲染</p>
<ul>
<li>根据父传入的数据渲染</li>
</ul>
<p>难点</p>
<ul>
<li>字体大小为10px，而浏览器最小字号为12px</li>
<li>解决办法：使用<code>scale</code>缩放到<code>0.85</code>倍 </li>
<li>产生的问题：会产生无法更改的外边距</li>
</ul>
<h4 id="轮播图"><a href="#轮播图" class="headerlink" title="轮播图"></a>轮播图</h4><p>接口</p>
<ul>
<li>增加数据库<code>banner.data.js</code></li>
<li>使用json-server默认接口，在<code>db.js</code>文件中，引入数据库并增加一个接口<code>/api/banner</code></li>
<li>注意默认接口是以根节点字段为路径的，不需要另外定义<br>前端</li>
<li>引入接口</li>
<li>创建<code>BannerView</code>文件，调用接口，渲染页面</li>
</ul>
<h4 id="分类菜单"><a href="#分类菜单" class="headerlink" title="分类菜单"></a>分类菜单</h4><p>接口</p>
<ul>
<li>增加数据库<code>menu.data.js</code></li>
<li>使用json-server默认接口，在<code>db.js</code>文件中，引入数据库并增加一个接口<code>/api/menu</code></li>
</ul>
<p>前端</p>
<ul>
<li>引入接口</li>
<li>创建<code>HomeMenu</code>文件，调用接口，获取数据</li>
<li>使用网格布局渲染</li>
</ul>
<h4 id="特价秒杀"><a href="#特价秒杀" class="headerlink" title="特价秒杀"></a>特价秒杀</h4><p>前端</p>
<blockquote>
<p>倒计时组件 —— CountDown</p>
</blockquote>
<ul>
<li>注意：要进行补0操作，使用<code>String.prototype.padStart()</code>方法</li>
<li>因为不显示天数，所以需要<code>时</code>的值需要再加上<code>天数*24</code></li>
<li>当倒计时为0时，会自动调用finish事件；定义一个变控制特价秒杀板块的显隐，在finish事件中改变变量的值将该板块下架</li>
</ul>
<blockquote>
<p>轮播图组件 —— Swipe 轮播</p>
</blockquote>
<ul>
<li>使用<code>RouterLink</code>包裹单个滑块，路由的参数根据每个商品的数据传入</li>
<li>难点：轮播图组件中单个滑块的宽度不能自适应，只能使用px单位<ul>
<li>单独写一个方法，将<code>px</code>转换成<code>vw</code> </li>
<li>在生命周期钩子函数中，使用<code>window.resize()</code>事件调用该方法；并在组件销毁时清理</li>
</ul>
</li>
</ul>
<p>后端</p>
<ul>
<li>增加数据库<code>seckillTimer.data.js</code></li>
<li>因为不需要逻辑操作，所以直接使用json-server默认接口，在<code>db.js</code>文件中，引入数据库并增加一个接口<code>/api/seckKill-Timer</code></li>
</ul>
<h4 id="首页分类推荐"><a href="#首页分类推荐" class="headerlink" title="首页分类推荐"></a>首页分类推荐</h4><p>前端</p>
<ul>
<li><code>HomeRecommand</code>组件由两部分组成<ul>
<li>头部的分类标签和每个标签对应的推荐内容——组件<code>RecommendItem</code></li>
</ul>
</li>
<li>怎样实现分类推荐<ul>
<li>使用动态组件，将推荐内容的组件名作为参数传入</li>
</ul>
</li>
<li>怎样获取不同类型的数据<ul>
<li>给动态组件传入类型值：<code>category</code></li>
</ul>
</li>
<li>实现下拉刷新和上拉加载更多<ul>
<li>注意：下拉刷新时必须给<code>RecommendItem</code>根组件添加<code>overflow-auto</code>和高度；</li>
<li>不能加在<code>HomeRecommand</code>组件里，否则会导致初次渲染时获取两次数据</li>
</ul>
</li>
<li>在组件<code>RecommendItem</code>中使用接口获取数据<ul>
<li>写一个方法获取数据，使用for循环遍历店铺组件<code>shopItem</code></li>
<li>由于上拉加载会在页面初次渲染时自动调用一次；所以在<code>onLoad</code>中调用获取数据的方法</li>
</ul>
</li>
</ul>
<p>后端</p>
<ul>
<li>和开发搜索类似<ul>
<li>使用同一个数据库</li>
<li>逻辑类似</li>
</ul>
</li>
<li>根据传递的参数<code>category、page、limit</code>来筛选数据</li>
<li>接口：<code>/api/recommend?category=0&amp;page=1&amp;limit=10</code></li>
</ul>
<h3 id="五、店铺详情"><a href="#五、店铺详情" class="headerlink" title="五、店铺详情"></a>五、店铺详情</h3><p>商家详情页构成</p>
<pre><code>shopIndex
├─ 顶部店铺信息 —— shopTop
├─ tab标签栏
│  ├─ 全部商品
│  │  └─ 菜单 —— AllGoods
│  │     └─ 异步组件 —— AsyncGoodsList
│  │        └─ 单个商品 —— GoodsItem
│  ├─ 评价 —— shopEvaluate
│  └─ 商家 —— shopKeeper
└─ 购物车 —— CartItem
   ├─ 购物车列表 
   │  └─ 单个商品 —— CartGoodsItem
   └─ 结算栏 —— CartSettlement
</code></pre>
<h4 id="顶部的店铺信息-——-shopTop组件"><a href="#顶部的店铺信息-——-shopTop组件" class="headerlink" title="顶部的店铺信息 —— shopTop组件"></a>顶部的店铺信息 —— <code>shopTop</code>组件</h4><blockquote>
<p>swiper轮播图组件</p>
</blockquote>
<ul>
<li>设置滑块间的间隔且最后一个滑块完整显示的方法：在<code>.van-swipe-item</code>中<ul>
<li>将单个滑块设置为怪异盒模型</li>
<li>将间隔设置为内边距</li>
<li>传入的单个滑块宽度为内容宽+padding</li>
</ul>
</li>
</ul>
<blockquote>
<p>展开和收缩</p>
</blockquote>
<ul>
<li>方法1：使用<code>useToggle</code>函数<ul>
<li>当value为false时，显示下箭头图标，并且对数据长度进行限制</li>
<li>当value为true时，显示上箭头图标，不限制对数据长度</li>
</ul>
</li>
<li>方法2：对于文字，可以使用<code>van-text-ellipsis</code>组件</li>
</ul>
<blockquote>
<p>后端接口</p>
</blockquote>
<ul>
<li>接口名<code>/api/shop/detail?shopId=1</code></li>
<li>根据路由传入的参数<code>shopId</code>筛选数据并返回</li>
</ul>
<h4 id="tab标签栏"><a href="#tab标签栏" class="headerlink" title="tab标签栏"></a>tab标签栏</h4><ul>
<li>利用动态组件实现不同面板的切换</li>
</ul>
<p>店铺菜单</p>
<ul>
<li>使用<code>IndexBar</code>索引栏组件布局</li>
<li>索引字符作为左侧菜单，<code>van-index-bar</code>作为右侧的对应内容</li>
<li>实现分类和点击左侧菜单即可调到对应内容</li>
</ul>
<blockquote>
<p>实现布局</p>
</blockquote>
<ul>
<li>页面分为左右两部分，先把该组件放到右侧的<code>goods-list</code>盒子</li>
<li>要把索引放到左侧盒子<code>goods-menu</code>，则必须使用<code>teleport</code>属性指定索引栏挂载的节点<code>#menu</code>，然后调整样式</li>
<li>实现的前提是左侧盒子要比<code>IndexBar</code>索引栏组件更早挂载到页面；然而它们是同一父组件，所以这是实现不了的</li>
<li>因此要将<code>IndexBar</code>索引栏组件单独放入一个组件，并使用<code>defineAsyncComponent</code>异步调用</li>
</ul>
<blockquote>
<p>左侧菜单实现吸顶盒效果</p>
</blockquote>
<ul>
<li>使用Sticky 粘性布局组件，设置<code>:offset-top</code></li>
<li>将该组件包裹在<code>scroll-wrapper</code>外面</li>
</ul>
<blockquote>
<p>左侧菜单实现滚动</p>
</blockquote>
<ul>
<li>安装并引入滚动插件 —— <code>better-scroll</code></li>
</ul>
<pre><code>npm i better-scroll

import BScroll from &#39;@better-scroll/core&#39;
</code></pre>
<ul>
<li>在节点<code>#menu</code>外面再包裹一个节点<code>scroll-wrapper</code></li>
<li>注意：调用时，子元素必须有内容<ul>
<li>因此设置侦听器：并且为了确保能接收数据，设置定时器，等索引列表<code>indexList</code>接收完成后再触发</li>
</ul>
</li>
<li>注意：子元素的高度必须超过<code>scroll-wrapper</code>的高度，因此需要计算它的高度：<code>屏幕高度-tab栏-购物车</code></li>
<li>该插件会默认将索引的点击跳转效果关闭，因此必须手动配置</li>
</ul>
<pre><code>watch(
  indexList,
  (value) =&gt; &#123;
    if (value.length &gt; 0) &#123;
      setTimeout(() =&gt; &#123;
        new BScroll(&#39;.scroll-wrapper&#39;, &#123;
          click: true
        &#125;)
      &#125;, 100)
    &#125;
  &#125;,
  &#123;
    immediate: true
  &#125;
)
</code></pre>
<blockquote>
<p>注意各部分的z-index</p>
</blockquote>
<ul>
<li><code>App</code>页面的底部<code>tabBar</code> —— 2</li>
<li><code>ShopIndex</code>页面和<code>HomeIndex</code>页面的分类<code>tabBar</code> —— <code>99</code></li>
<li><code>ShopIndex</code>页面的底部购物车 —— 100</li>
<li>页面顶部的<code>topBar</code>导航 —— 1</li>
</ul>
<blockquote>
<p>数据渲染</p>
</blockquote>
<ul>
<li>在异步组件<code>AsyncGoodsList</code>中使用接口<code>/api/shop/goods?shopId</code>接收数据，渲染页面</li>
<li>右侧使用for循环商品组件<code>GoodsItem</code>来实现商品列表</li>
<li>将<code>shopId</code>和商品数据传递给<code>GoodsItem</code></li>
</ul>
<blockquote>
<p>实现点击商品跳转到详情页</p>
</blockquote>
<ul>
<li>使用vue Router编程式导航来实现</li>
<li>给<code>GoodsItem</code>的根组件，绑定点击的方法</li>
<li>当商品被点击时就传入<code>shopId</code>和<code>goodsId</code>，使用<code>push</code>方法来导航到<code>name=goods</code>的路由，即商品详情页</li>
</ul>
<blockquote>
<p>注意区分：</p>
</blockquote>
<ul>
<li><code>useRouter</code>函数访问到 router 实例，可以实现路由间的跳转等</li>
<li><code>useRoute</code>函数访问到当前路由，可以获取当前路由携带的参数</li>
</ul>
<h4 id="购物车-——-CartItem组件"><a href="#购物车-——-CartItem组件" class="headerlink" title="购物车 —— CartItem组件"></a>购物车 —— <code>CartItem</code>组件</h4><blockquote>
<p>该组件由购物车内容和结算面板组成</p>
</blockquote>
<ul>
<li>购物车内容使用Popup 弹出层实现，点击结算面板时就会从底部弹出<ul>
<li>其中包含的商品列表使用<code>CartGoodsItem</code>组件，进行for循环实现</li>
<li><code>CartGoodsItem</code>组件和<code>GoodsItem</code>类似，但不同之处不方便复用，因此拆分成两个</li>
</ul>
</li>
<li>结算面板由<code>CartSettlement</code>组件实现</li>
</ul>
<blockquote>
<p>UseCartStore仓库</p>
</blockquote>
<ul>
<li>使用Map来保存购物车的数据，实现店铺和店铺购物车数据的一一对应</li>
</ul>
<pre><code>//数据结构
new Map([
   // [shopId,shopInfos],
    [1,&#123;
        shopName:&#39;xxx&#39;,
        goodList:[
             &#123;
                goodsId:&#39;10001&#39;
                name: &#39;B级-进口香蕉2根/300-350g&#39;|商品名称
                imgUrl: &#39;/images/goods/type1-01.jpg&#39;, // 商品图片
                cartCount: 1, // 购物车数量
                checked: false,  // 添加购物车按扭选中
                // ...更多字段
            &#125;,
        ]
    &#125;]
])
</code></pre>
<ul>
<li>将购物车数据保存到本地存储：使用<code>useLocalStorage</code>实现响应式</li>
</ul>
<table>
<thead>
<tr>
<th>方法</th>
<th>作用</th>
<th>参数</th>
</tr>
</thead>
<tbody><tr>
<td><code>cartList</code></td>
<td>所有购物车信息</td>
<td>-</td>
</tr>
<tr>
<td><code>pushProductToCart</code></td>
<td>添加购物数量（+1）</td>
<td><code>shopId</code>、<code>shopName</code>、<code>goods</code></td>
</tr>
<tr>
<td><code>reduceProductFromCart</code></td>
<td>减少购物数量（-1）</td>
<td><code>shopId</code>、<code>goodsId</code></td>
</tr>
<tr>
<td><code>getGoodsCartCount</code></td>
<td>获取某个店铺的某件商品的加购数量</td>
<td><code>shopId</code>、<code>goodsId</code></td>
</tr>
<tr>
<td><code>getShopCartInfo</code></td>
<td>返回对应店铺的购物车列表信息</td>
<td><code>shopId</code></td>
</tr>
<tr>
<td><code>toggleSelect</code></td>
<td>动态切换单选</td>
<td><code>shopId</code>、<code>goodsId</code></td>
</tr>
<tr>
<td><code>isAllSelect</code></td>
<td>判断是否全选</td>
<td><code>shopId</code></td>
</tr>
<tr>
<td><code>setAllSelect</code></td>
<td>设置全选</td>
<td><code>shopId</code></td>
</tr>
<tr>
<td><code>cancleAllSelect</code></td>
<td>取消全选</td>
<td><code>shopId</code></td>
</tr>
<tr>
<td><code>toggleAllSelect</code></td>
<td>动态切换全选状态</td>
<td><code>shopId</code></td>
</tr>
<tr>
<td><code>cartGoodsNum</code></td>
<td>计算店铺加购的商品数量</td>
<td><code>shopId</code></td>
</tr>
<tr>
<td><code>selectGoodsNum</code></td>
<td>计算购物车内选中的商品数量</td>
<td><code>shopId</code></td>
</tr>
<tr>
<td><code>TotalPrice</code></td>
<td>计算总价格</td>
<td><code>shopId</code></td>
</tr>
<tr>
<td><code>clearCart</code></td>
<td>清空购物车</td>
<td><code>shopId</code></td>
</tr>
<tr>
<td><code>selectToPayGoods</code></td>
<td>获取单个店铺已选中的商品信息，用于结算</td>
<td><code>shopId</code></td>
</tr>
<tr>
<td><code>getCartList</code></td>
<td>返回购物车列表数据</td>
<td>-</td>
</tr>
<tr>
<td><code>getAllCartPrice</code></td>
<td>计算所有店铺中选中商品的总价格</td>
<td>-</td>
</tr>
<tr>
<td><code>getAllCheckedGoodsList</code></td>
<td>获取所有店铺以及被选中的商品 <code>map</code>结构</td>
<td>-</td>
</tr>
<tr>
<td><code>clearAllCheckedFromCart</code></td>
<td>删除购物车中已支付&#x2F;取消支付的商品</td>
<td>-</td>
</tr>
<tr>
<td><code>deleteCartGoods</code></td>
<td>删除购物车中的商品</td>
<td><code>shopId</code>、<code>goodsId</code></td>
</tr>
</tbody></table>
<blockquote>
<p>逻辑处理</p>
</blockquote>
<ul>
<li>加入购物车<code>pushProducetToCart</code><ul>
<li>传入对应的shopId、shopName、goods(商品信息)</li>
<li>先根据shopId判断，如果没有该店铺数据就新增一条</li>
<li>再根据goodsId判断，如果没有就在对应店铺的goodList里添加一条数据；如果有就更新数量和选中状态</li>
</ul>
</li>
<li>减少商品数量<code>removeProductFromCart</code><ul>
<li>传入对应的shopId、goodsId</li>
<li>先根据shopId找到该店铺对应的购物车数据</li>
<li>再根据goodsId判断，如果有将该商品加购数量-1；如果-1之后是0，那就把该商品数据删除；如果删除后goodList没有数据了，就把店铺信息删除</li>
</ul>
</li>
</ul>
<blockquote>
<p>数量组件的数据获取</p>
</blockquote>
<ul>
<li>店铺商品菜单栏<ul>
<li><code>shopName</code>：<code>AsyncGoodsList</code>–&gt;<code>GoodsItem</code>–&gt;<code>ToCart</code></li>
<li><code>shopId</code>和<code>Goods</code>：<code>GoodsItem</code>–&gt;<code>ToCart</code></li>
</ul>
</li>
<li>购物车结算<ul>
<li>都是由<code>CartItem</code>根据路由参数获取，传递给<code>CartGoodsItem</code>–&gt;<code>ToCart</code></li>
<li><code>shopName</code>：<code>CartItem</code>根据路由参数获取</li>
<li><code>shopId</code>和<code>Goods</code>：<code>CartItem</code>使用仓库的<code>getShopCartInfo</code>方法获取</li>
<li>购物车中的商品列表也是使用<code>getShopCartInfo</code>方法获取的数据进行渲染</li>
</ul>
</li>
<li>数量组件中的数量：使用仓库的<code>getGoodsCartInfo</code>方法获取；</li>
<li>注意使用上面两个方法时要用计算属性实现响应</li>
</ul>
<blockquote>
<p>购物车价格、数量的获取</p>
</blockquote>
<ul>
<li>使用仓库中定义的方法，实现对应数据的渲染</li>
</ul>
<blockquote>
<p>优化购物车样式</p>
</blockquote>
<ul>
<li>没有添加商品时，底部结算面板为灰色，不能点击弹出购物车列表，不能跳转到结算页面，没有徽标</li>
</ul>
<h3 id="六、收货地址"><a href="#六、收货地址" class="headerlink" title="六、收货地址"></a>六、收货地址</h3><h4 id="提交结算后的流程"><a href="#提交结算后的流程" class="headerlink" title="提交结算后的流程"></a>提交结算后的流程</h4><img src="https://github.com/hermiablog/shopApp/blob/main/screen/process-enterShop.png" style="max-width: 100%;">

<p>确认订单页</p>
<blockquote>
<p>分成三个组件实现：收货信息、商品列表、底部结算</p>
</blockquote>
<ul>
<li>由于商品列表和底部结算组件都需要复用，所以数据都由父组件传入<blockquote>
<p>收货信息的渲染：</p>
</blockquote>
</li>
<li>先看是否有<code>addressId</code>，如果有就代表是刚选择完回到该页面</li>
<li>再找默认地址</li>
<li>如果都没有就显示选择地址的样式</li>
</ul>
<p>选择收货地址页</p>
<ul>
<li>可进行选择、修改、删除、添加地址的操作<blockquote>
<p>页面跳转</p>
</blockquote>
</li>
<li>如果是编辑地址，则需要携带<code>addressId</code>跳转</li>
<li>如果是新增地址，则不需要参数</li>
<li>如果是选择地址，则需要带着<code>shopId</code>和<code>addressId</code>跳转到确认订单页</li>
</ul>
<blockquote>
<p>注意：处理选择地址后的后退</p>
</blockquote>
<ul>
<li>选择地址后会直接跳转到确认订单页，此时如果点击顶部导航的后退键，则会返回到选择地址页；逻辑上应该回到店铺</li>
<li>路径：店铺–&gt;不带<code>addressId</code>的确认订单–&gt;选择地址–&gt;带<code>addressId</code>的确认订单页</li>
<li>不做任何处理时，在带<code>addressId</code>确认订单点击返回–&gt;选择地址–&gt;不带<code>addressId</code>确认订单–&gt;店铺<blockquote>
<p>处理方法</p>
</blockquote>
</li>
<li>首先：选择地址后的跳转到确认订单页的方法，用<code>replace</code>代替<code>push</code>方法；它与 push 方法一样用来导航到一个新的 URL，但会替换掉之前的 URL，无法后退到之前 URL</li>
<li>做完这步之后，路径变成：在带<code>addressId</code>确认订单点击返回–&gt;不带<code>addressId</code>确认订单–&gt;店铺</li>
<li>因此需要设置定时器，在跳转到确认订单页前，使用<code>history.back()</code>回到不带<code>addressId</code>的确认订单页，然后定时结束使用<code>replace</code>方法跳转到确认订单页；这样就可以直接返回店铺</li>
</ul>
<p>地址编辑页和新增地址页</p>
<ul>
<li>这两个页面是同一组件和同一套样式，只是根据传入的参数不同，数据的渲染是不同的<blockquote>
<p>页面布局</p>
</blockquote>
</li>
<li>内容使用Form表单组件渲染，其中地区选择部分，使用<code>van-area</code>组件实现</li>
<li>在表单中使用 Area 组件时的属性或方法</li>
</ul>
<pre><code>// 省市区数据的类型
interface IArearList &#123;
  text: string
  value: string
  children: IArearList[]
&#125;
const result = ref() //显示选择后的省市区数据
const showArea = ref(false) //弹窗显隐
const areaCode = ref(&#39;110101&#39;) //选择器的默认初始的地区
const onConfirm = (&#123; selectedOptions &#125;: &#123; selectedOptions: IArearList[] &#125;) =&gt; &#123;
  showArea.value = false
  result.value = selectedOptions.map((item) =&gt; item.text).join(&#39;/&#39;)
&#125;
&lt;van-field
  v-model=&quot;result&quot;
  is-link
  readonly
  name=&quot;area&quot;
  label=&quot;地区选择&quot;
  placeholder=&quot;点击选择省市区&quot;
  @click=&quot;showArea = true&quot;
/&gt;
&lt;van-popup v-model:show=&quot;showArea&quot; position=&quot;bottom&quot;&gt;
  &lt;van-area
    :area-list=&quot;areaList&quot;
    v-model=&quot;areaCode&quot;
    @confirm=&quot;onConfirm&quot;
    @cancel=&quot;showArea = false&quot;
  /&gt;
&lt;/van-popup&gt;
</code></pre>
<blockquote>
<p>遇到的问题：在引入<code>area-data</code>时，报错：“找不到 @vant&#x2F;area-data”或其相应的类型声明”</p>
</blockquote>
<ul>
<li>解决办法：将<code>node_modules</code>下存放省市区数据的<code>index.esm.mjs</code>和类型声明文档<code>index.d.ts</code>复制到<code>src/assets</code>中，接着更改引入地址即可</li>
</ul>
<blockquote>
<p>数据渲染</p>
</blockquote>
<ul>
<li>如果路由携带了<code>addressId</code>参数，则根据它获取地址数据，渲染在页面</li>
<li>如果没有，则什么都不需要渲染</li>
</ul>
<h4 id="API接口"><a href="#API接口" class="headerlink" title="API接口"></a>API接口</h4><blockquote>
<p>获取收货地址信息接口<code>api/address</code>或<code>api.address/addressId</code></p>
</blockquote>
<ul>
<li>可以使用<code>api/address</code>获取用户的所有地址数据</li>
<li>也可以使用或<code>api.address/addressId</code>获取单条地址数据</li>
</ul>
<blockquote>
<p>其它接口</p>
</blockquote>
<ul>
<li>新增收货地址：<code>/api/address</code> —— post请求</li>
<li>修改收货地址：<code>/api/address</code> —— put请求</li>
<li>删除收货地址：<code>/api/address</code> —— delete请求</li>
<li>获取默认地址：<code>/api/address/default</code> —— get请求</li>
</ul>
<h3 id="七、购物车和订单页"><a href="#七、购物车和订单页" class="headerlink" title="七、购物车和订单页"></a>七、购物车和订单页</h3><h4 id="购物车页面布局"><a href="#购物车页面布局" class="headerlink" title="购物车页面布局"></a>购物车页面布局</h4><pre><code>shopIndex
├─ 顶部导航 
├─ 购物车列表 —— CartList
│  └─ 单个商品 —— CartGoodsItem
├─ 底部结算 —— CartSettlement
└─ 确认订单 —— CartOrderComfirmation
</code></pre>
<blockquote>
<p>购物车列表</p>
</blockquote>
<ul>
<li>使用<code>SwipeCell</code>滑动单元格，实现商品的左右滑动效果</li>
<li>删除按钮的点击事件，使用<code>cartStore</code>的<code>deleteCartGoods</code>方法实现删除</li>
</ul>
<blockquote>
<p>空页面</p>
</blockquote>
<ul>
<li>使用<code>isNull</code>组件</li>
</ul>
<h4 id="购物车数据"><a href="#购物车数据" class="headerlink" title="购物车数据"></a>购物车数据</h4><blockquote>
<p>购物车列表：</p>
</blockquote>
<ul>
<li>在<code>cartStore</code>里定义一个方法<code>getCartList</code>，返回购物车数据<code>cartList</code></li>
</ul>
<blockquote>
<p>确认订单页数据</p>
</blockquote>
<ul>
<li>复制在店铺结算时的确认订单页，加以修改，二者的购物车数据不同</li>
<li>从底部tab进入购物车进行结算时，需要获取的是购物车中所有店铺被选中的商品，而不是单个店铺</li>
<li>在<code>cartStore</code>中定义方法<code>getAllCheckedGoodsList</code>，用来获取所有店铺以及被选中的商品，返回的数据为map结构</li>
</ul>
<h4 id="确认支付"><a href="#确认支付" class="headerlink" title="确认支付"></a>确认支付</h4><blockquote>
<p>功能</p>
</blockquote>
<ul>
<li>点击确认支付后，需要完成：模拟支付、生成订单、删除购物车中已结算商品、跳转到订单页</li>
<li>第一步：根据点击确认支付或取消支付，会生成不同的订单状态：已完成&#x2F;已取消</li>
<li>第二步：调用接口<code>/generate/order</code>，传入订单信息，生成订单数据</li>
<li>第三步：使用<code>cartStore</code>中的方法，将提交支付的商品从购物车中删除</li>
<li>第四步：跳转到订单页</li>
</ul>
<blockquote>
<p>实现</p>
</blockquote>
<ul>
<li>定义一个字段<code>orderList</code>，保存订单数据，在调用生成订单的接口时传入，包括：<ul>
<li>继承购物车数据：<code>shopName</code>、<code>goodsList</code></li>
<li>新增：<code>userId</code>、<code>orderId</code>、<code>shopId</code>、<code>addressId</code>、<code>isCanceled</code>(表示订单状态)</li>
</ul>
</li>
</ul>
<p>接口</p>
<ul>
<li>在后端数据库中定义一个函数，返回空的订单数组<blockquote>
<p>生成订单<code>/generate/order</code></p>
</blockquote>
</li>
<li>在生成订单的接口中，接收请求体中传入的订单数据<ul>
<li>如果是数组，表示多个店铺的订单数据，遍历数组，给每个订单新增<code>orderId</code>字段；并添加进数据库</li>
<li>如果是单个数据，直接新增<code>orderId</code>字段，添加进数据库<blockquote>
<p>返回所有订单<code>/order/list</code></p>
</blockquote>
</li>
</ul>
</li>
<li>返回订单数据库的全部内容</li>
</ul>
<h4 id="订单页"><a href="#订单页" class="headerlink" title="订单页"></a>订单页</h4><blockquote>
<p>数据</p>
</blockquote>
<ul>
<li>调用接口<code>/order/list</code>，获取所有订单<blockquote>
<p>空页面</p>
</blockquote>
</li>
<li>使用<code>isNull</code>组件</li>
</ul>
<h3 id="八、商品详情页"><a href="#八、商品详情页" class="headerlink" title="八、商品详情页"></a>八、商品详情页</h3><h4 id="布局中需要注意"><a href="#布局中需要注意" class="headerlink" title="布局中需要注意"></a>布局中需要注意</h4><blockquote>
<p>加入购物车按钮与数量组件</p>
</blockquote>
<ul>
<li>根据<code>shopId</code>和<code>goodsId</code>获取当前商品的加购数量；如果数量为0，则显示加入购物车按钮</li>
<li>点击加入购物车，就调用<code>pushProductToCart</code>方法将当前商品加入购物车数据</li>
</ul>
<h4 id="商品数据"><a href="#商品数据" class="headerlink" title="商品数据"></a>商品数据</h4><blockquote>
<p>需要什么</p>
</blockquote>
<ul>
<li>商品详情的渲染需要<code>goods</code>数据</li>
<li>使用数量组件、获取当前商品的加购数量、加入购物车等都需要<code>shopId</code>和<code>shopName</code></li>
</ul>
<blockquote>
<p>接口</p>
</blockquote>
<ul>
<li>需要传入：<code>shopId</code>和<code>goodsId</code></li>
<li>在数据库中，我们需要的<code>goods</code>数据包含在<code>data</code>，<code>data</code>字段包含了该店铺所有的商品信息</li>
<li>因此后端接口在拿到参数后：<ul>
<li>先找到对应的店铺</li>
<li>将该店铺不同类别下的所有商品放在一个数组中</li>
<li>遍历数组，并找到和<code>goodsId</code>相同的商品</li>
<li>在响应体中，除了返回前一步找到的商品数据，还要加上<code>shopId</code>和<code>shopName</code></li>
</ul>
</li>
</ul>
<h3 id="九、关联用户"><a href="#九、关联用户" class="headerlink" title="九、关联用户"></a>九、关联用户</h3><p>一般情况下，在项目初始搭建的时候就应该考虑到这一点</p>
<blockquote>
<p>购物车关联用户</p>
</blockquote>
<ul>
<li>拿到<code>useInfo</code>状态管理库中的<code>userId</code></li>
<li>将本地存储中保存用户的购物车数据的字段与用户ID关联</li>
<li>创建侦听器，一旦用户id变化，LocalStorage就会重新创建字段保存该用户的购物车数据</li>
</ul>
<blockquote>
<p>订单关联用户</p>
</blockquote>
<ul>
<li>在生成订单时，将userId加入订单数据，发送到后端</li>
<li>前端在调用获取订单的接口时，需要将用户id传入</li>
<li>获取订单的接口，要根据请求体中携带的用户id，对订单数据进行筛选，返回当前用户的订单数据</li>
</ul>
<blockquote>
<p>收货地址关联用户</p>
</blockquote>
<ul>
<li>在调用接口时传入<code>userId</code></li>
<li>修改获取&#x2F;删除&#x2F;编辑&#x2F;新增用户地址的接口，使用userId对数据进行筛选</li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">hermia</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://hermiablog.github.io/2023/12/24/vue3%E5%85%A8%E5%AE%B6%E6%A1%B6-Ts-vant-%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E8%B4%AD%E7%89%A9%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/">https://hermiablog.github.io/2023/12/24/vue3%E5%85%A8%E5%AE%B6%E6%A1%B6-Ts-vant-%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E8%B4%AD%E7%89%A9%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">hermia</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/app/">
                                    <span class="chip bg-color">app</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="qq,qzone,wechat,weibo" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2023/12/24/vue3%E5%85%A8%E5%AE%B6%E6%A1%B6-Ts-vant-%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E8%B4%AD%E7%89%A9%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/">
                    <div class="card-image">
                        
                        <img src="/medias/featureimages/41.jpg" class="responsive-img" alt="vue3全家桶+Ts+vant 前后端分离购物商城项目介绍">
                        
                        <span class="card-title">vue3全家桶+Ts+vant 前后端分离购物商城项目介绍</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            项目介绍及搭建过程
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-12-24
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            hermia
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/app/">
                        <span class="chip bg-color">app</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/12/14/JS%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%88%E4%BA%8C%E5%8D%81%E5%9B%9B%EF%BC%89/">
                    <div class="card-image">
                        
                        <img src="/medias/featureimages/36.jpg" class="responsive-img" alt="JS核心知识点（二十四）">
                        
                        <span class="card-title">JS核心知识点（二十四）</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Module模块系统、ES6Proxy 代理 与 Reflect反射
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-12-14
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%8A%80%E6%9C%AF/" class="post-category">
                                    技术
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/JS/">
                        <span class="chip bg-color">JS</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


  </div>
  <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
    <div class="toc-widget card" style="background-color: white">
      <div class="toc-title">
        <i class="far fa-list-alt"></i>&nbsp;&nbsp;目录
      </div>
      <div id="toc-content"></div>
    </div>
  </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
  <a class="btn-floating btn-large bg-color">
    <i class="fas fa-list-ul"></i>
  </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
  $(function () {
      tocbot.init({
          tocSelector: '#toc-content',
          contentSelector: '#articleContent',
          headingsOffset: -($(window).height() * 0.4 - 45),
          collapseDepth: Number('0'),
          headingSelector: 'h2, h3, h4'
      });

      // modify the toc link href to support Chinese.
      let i = 0;
      let tocHeading = 'toc-heading-';
      $('#toc-content a').each(function () {
          $(this).attr('href', '#' + tocHeading + (++i));
      });

      // modify the heading title id to support Chinese.
      i = 0;
      $('#articleContent').children('h2, h3, h4').each(function () {
          $(this).attr('id', tocHeading + (++i));
      });

      // Set scroll toc fixed.
      let tocHeight = parseInt($(window).height() * 0.4 - 64);
      let $tocWidget = $('.toc-widget');
      $(window).scroll(function () {
          let scroll = $(window).scrollTop();
          /* add post toc fixed. */
          if (scroll > tocHeight) {
              $tocWidget.addClass('toc-fixed');
          } else {
              $tocWidget.removeClass('toc-fixed');
          }
      });

      
      /* 修复文章卡片 div 的宽度. */
      let fixPostCardWidth = function (srcId, targetId) {
          let srcDiv = $('#' + srcId);
          if (srcDiv.length === 0) {
              return;
          }

          let w = srcDiv.width();
          if (w >= 450) {
              w = w + 21;
          } else if (w >= 350 && w < 450) {
              w = w + 18;
          } else if (w >= 300 && w < 350) {
              w = w + 16;
          } else {
              w = w + 14;
          }
          $('#' + targetId).width(w);
      };

      // 切换TOC目录展开收缩的相关操作.
      const expandedClass = 'expanded';
      let $tocAside = $('#toc-aside');
      let $mainContent = $('#main-content');
      $('#floating-toc-btn .btn-floating').click(function () {
          if ($tocAside.hasClass(expandedClass)) {
              $tocAside.removeClass(expandedClass).hide();
              $mainContent.removeClass('l9');
          } else {
              $tocAside.addClass(expandedClass).show();
              $mainContent.addClass('l9');
          }
          fixPostCardWidth('artDetail', 'prenext-posts');
      });
      
  });
</script>

    

</main>




    <footer class="page-footer bg-color">
   <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        font-size: 15px;
        color: #a3ddf0;
        /* color: #59cde9; */
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="2450546498"
                   fixed='true'
                   autoplay='false'
                   theme='#59cde9'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
 
  <div
    class="container row center-align"
    style="margin-bottom: 15px !important;"
  >
    <div class="col s12 m8 l8 copy-right">
      Copyright&nbsp;&copy; 
      <span id="year">2023</span>
      
      <span id="year">2023</span>
      <a href="/about" target="_blank"
        >hermia</a
      >
      |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
      |&nbsp;Theme&nbsp;<a
        href="https://github.com/blinkfox/hexo-theme-matery"
        target="_blank"
        >Matery</a
      >
      <br />
           
      <span id="busuanzi_container_site_pv">
        |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span
          id="busuanzi_value_site_pv"
          class="white-color"
        ></span
        >&nbsp;次
      </span>
       
      <span id="busuanzi_container_site_uv">
        |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span
          id="busuanzi_value_site_uv"
          class="white-color"
        ></span
        >&nbsp;人
      </span>
      
      <br />
      
      <span id="sitetime">载入运行时间...</span>
      <script>
        function siteTime() {
          var seconds = 1000;
          var minutes = seconds * 60;
          var hours = minutes * 60;
          var days = hours * 24;
          var years = days * 365;
          var today = new Date();
          var startYear = "2023";
          var startMonth = "11";
          var startDate = "14";
          var startHour = "0";
          var startMinute = "0";
          var startSecond = "0";
          var todayYear = today.getFullYear();
          var todayMonth = today.getMonth() + 1;
          var todayDate = today.getDate();
          var todayHour = today.getHours();
          var todayMinute = today.getMinutes();
          var todaySecond = today.getSeconds();
          var t1 = Date.UTC(
            startYear,
            startMonth,
            startDate,
            startHour,
            startMinute,
            startSecond
          );
          var t2 = Date.UTC(
            todayYear,
            todayMonth,
            todayDate,
            todayHour,
            todayMinute,
            todaySecond
          );
          var diff = t2 - t1;
          var diffYears = Math.floor(diff / years);
          var diffDays = Math.floor(diff / days - diffYears * 365);
          var diffHours = Math.floor(
            (diff - (diffYears * 365 + diffDays) * days) / hours
          );
          var diffMinutes = Math.floor(
            (diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
              minutes
          );
          var diffSeconds = Math.floor(
            (diff -
              (diffYears * 365 + diffDays) * days -
              diffHours * hours -
              diffMinutes * minutes) /
              seconds
          );
          if (startYear == todayYear) {
            document.getElementById("year").innerHTML = todayYear;
            document.getElementById("sitetime").innerHTML =
              "本站已安全运行 " +
              diffDays +
              " 天 " +
              diffHours +
              " 小时 " +
              diffMinutes +
              " 分钟 " +
              diffSeconds +
              " 秒";
          } else {
            document.getElementById("year").innerHTML =
              startYear + " - " + todayYear;
            document.getElementById("sitetime").innerHTML =
              "本站已安全运行 " +
              diffYears +
              " 年 " +
              diffDays +
              " 天 " +
              diffHours +
              " 小时 " +
              diffMinutes +
              " 分钟 " +
              diffSeconds +
              " 秒";
          }
        }
        setInterval(siteTime, 1000);
      </script>
      
      <br />
      
    </div>
    <div class="col s12 m4 l4 social-link social-statis">
      
<a
  href="https://github.com/hermiablog/hermiablog.github.io"
  class="tooltipped"
  target="_blank"
  data-tooltip="访问我的GitHub"
  data-position="top"
  data-delay="50"
>
  <i class="fab fa-github"></i>
</a>
 
<a
  href="mailto:1587837237@qq.com"
  class="tooltipped"
  target="_blank"
  data-tooltip="邮件联系我"
  data-position="top"
  data-delay="50"
>
  <i class="fas fa-envelope-open"></i>
</a>
<!-- 
   
<a
  href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1587837237"
  class="tooltipped"
  target="_blank"
  data-tooltip="QQ联系我: 1587837237"
  data-position="top"
  data-delay="50"
>
  <i class="fab fa-qq"></i>
</a>
    -->

    </div>
  </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
